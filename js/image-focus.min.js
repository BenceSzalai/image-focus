!function(t,i,a){function e(i,a){this.element=i,this.options=t.extend({},n,a),this._defaults=n,this._name=o,this.init()}var o="imageFocus",n={},s={attachmentId:!1,focus:{x:50,y:50}},c={imageFocus:{self:"image-focus",wrapper:"image-focus__wrapper",img:"image-focus__img",point:"image-focus__point",clickarea:"image-focus__clickarea"}};e.prototype={init:function(){this.setImageData(),this.addFocusPoint(),this.addCropButton(),t("."+c.imageFocus.clickarea).on("click",this.moveFocusPoint)},setImageData:function(){s.attachmentId=t(this.element).data("id")},addFocusPoint:function(){console.log("add focuspoint");var i,a=t(".edit-attachment-frame .attachment-media-view .details-image");a.addClass(c.imageFocus.img),a.wrap('<div class="'+c.imageFocus.self+'"><div class="'+c.imageFocus.wrapper+'"></div></div>'),(i=t("."+c.imageFocus.wrapper)).append('<div class="'+c.imageFocus.point+'"></div>'),i.append('<div class="'+c.imageFocus.clickarea+'"></div>')},moveFocusPoint:function(i){var a=t(this).width(),e=t(this).height(),o=(i.pageX-t(this).offset().left)/a*100,n=(i.pageY-t(this).offset().top)/e*100;s.focus.x=o,s.focus.y=n,console.log("percentageX:"+o.toFixed(2)+", percentageY:"+n.toFixed(2)),t("."+c.imageFocus.point).css({left:o+"%",top:n+"%"})},addCropButton:function(){$button=t("image-focus__button"),$button.on("click",this.sendImageCropDataByAjax())},sendImageCropDataByAjax:function(){t.ajax({type:"POST",url:ajaxurl,data:{action:"initialize-crop",image:JSON.stringify(s)},dataType:"json"})}},t.fn[o]=function(i){return this.each(function(){t.data(this,"plugin_"+o)||t.data(this,"plugin_"+o,new e(this,i))})}}(jQuery,window,document),function(t,i,a){t(a).on("ready",function(){setInterval(function(){var i=t(".attachment-details");if(i.find(".details-image").length&&!t(".image-focus").length)try{i.imageFocus()}catch(t){console.log(t)}},500)})}(jQuery,window,document);