!function(t,a,i){"use strict";function o(a,i){this.element=a,this.options=t.extend({},n,i),this._defaults=n,this._name=e,this.init()}var e="imageFocus",n={},s={id:!1,focusPoint:{x:50,y:50}},c={imageFocus:{self:"image-focus",wrapper:"image-focus__wrapper",img:"image-focus__img",point:"image-focus__point",clickarea:"image-focus__clickarea",button:"image-focus__button"},button:{self:"button",primary:"button-primary",disabled:"button-disabled"}};o.prototype={init:function(){var a=this;this.setImageData(),this.addFocusPoint(),this.addCropButton(),t("."+c.imageFocus.clickarea).on("click",function(t){a.moveFocusPoint(t,this),a.highlightCropButton()}),t("."+c.imageFocus.button).on("click",this.sendImageCropDataByAjax)},setImageData:function(){s.id=t(this.element).data("id")},addFocusPoint:function(){var a,i=t(".edit-attachment-frame .attachment-media-view .details-image");i.addClass(c.imageFocus.img),i.wrap('<div class="'+c.imageFocus.self+'"><div class="'+c.imageFocus.wrapper+'"></div></div>'),(a=t("."+c.imageFocus.wrapper)).append('<div class="'+c.imageFocus.point+'"></div>'),a.append('<div class="'+c.imageFocus.clickarea+'"></div>')},moveFocusPoint:function(a,i){var o=t(i).width(),e=t(i).height(),n=(a.pageX-t(i).offset().left)/o*100,u=(a.pageY-t(i).offset().top)/e*100;s.focusPoint.x=n,s.focusPoint.y=u,t("."+c.imageFocus.point).css({left:n+"%",top:u+"%"})},addCropButton:function(){var a='<button type="button" class="'+c.button.self+" "+c.button.disabled+" crop-attachment "+c.imageFocus.button+'">'+focusPointL10n.cropButton+"</button>";t(this.element).find(".attachment-actions").append(a)},highlightCropButton:function(){var a=t("."+c.imageFocus.button);a.removeClass(c.button.disabled),a.addClass(c.button.primary)},disableCropButton:function(){var a=t("."+c.imageFocus.button);a.removeClass(c.button.primary),a.addClass(c.button.disabled)},sendImageCropDataByAjax:function(){t.ajax({type:"POST",url:ajaxurl,data:{action:"initialize-crop",attachment:s},dataType:"json"})}},t.fn[e]=function(a){return this.each(function(){t.data(this,"plugin_"+e)||t.data(this,"plugin_"+e,new o(this,a))})}}(jQuery,window,document),function(t,a,i){t(i).on("ready",function(){setInterval(function(){var a=t(".attachment-details");if(a.find(".details-image").length&&!t(".image-focus").length)try{a.imageFocus()}catch(t){console.log(t)}},500)})}(jQuery,window,document);